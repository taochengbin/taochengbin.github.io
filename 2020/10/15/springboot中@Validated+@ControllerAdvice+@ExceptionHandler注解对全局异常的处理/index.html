<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>springboot中@Validated+@ControllerAdvice+@ExceptionHandler注解对全局异常的处理 | Ruby</title><meta name="author" content="陶成彬"><meta name="copyright" content="陶成彬"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="前言 正文 postman调用返回    前言为了解决什么问题：1.前端传入大量繁琐数据需要校验，会产生大量 if else语句以及try catch语句导致代码冗杂，不美观。用@Validated注解可以很好的解决。它根据实体类配置的校验规则在进入controller接口的时候就会自动校验参数。2.controller中每一个接口请求都要对异常进行处理，若接口不断增多，不同的异常也会不断增">
<meta property="og:type" content="article">
<meta property="og:title" content="springboot中@Validated+@ControllerAdvice+@ExceptionHandler注解对全局异常的处理">
<meta property="og:url" content="http://example.com/2020/10/15/springboot%E4%B8%AD@Validated+@ControllerAdvice+@ExceptionHandler%E6%B3%A8%E8%A7%A3%E5%AF%B9%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="Ruby">
<meta property="og:description" content="前言 正文 postman调用返回    前言为了解决什么问题：1.前端传入大量繁琐数据需要校验，会产生大量 if else语句以及try catch语句导致代码冗杂，不美观。用@Validated注解可以很好的解决。它根据实体类配置的校验规则在进入controller接口的时候就会自动校验参数。2.controller中每一个接口请求都要对异常进行处理，若接口不断增多，不同的异常也会不断增">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/wall/2.jpg">
<meta property="article:published_time" content="2020-10-15T07:26:46.650Z">
<meta property="article:modified_time" content="2020-10-20T06:29:47.315Z">
<meta property="article:author" content="陶成彬">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/wall/2.jpg"><link rel="shortcut icon" href="/img/wall/31.jpg"><link rel="canonical" href="http://example.com/2020/10/15/springboot%E4%B8%AD@Validated+@ControllerAdvice+@ExceptionHandler%E6%B3%A8%E8%A7%A3%E5%AF%B9%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.2.0',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isSidebar: true,
  postUpdate: '2020-10-20 14:29:47'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><div class="aplayer" data-id="2693598459" data-server="netease" data-type="playlist" data-fixed="true" data-listFolded="false" data-order="random" data-preload="none"></div><link rel="stylesheet" href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css"><script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Ruby" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">40</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-diamond"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-video-camera"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">postman调用返回</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(/img/wall/2.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Ruby</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-diamond"></i><span> 生活</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 说说</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-video-camera"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">springboot中@Validated+@ControllerAdvice+@ExceptionHandler注解对全局异常的处理</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-10-15T07:26:46.650Z" title="发表于 2020-10-15 15:26:46">2020-10-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-10-20T06:29:47.315Z" title="更新于 2020-10-20 14:29:47">2020-10-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Spring-Boot/">Spring Boot</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><!-- toc -->

<ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="#%E6%AD%A3%E6%96%87">正文</a></li>
<li><a href="#postman%E8%B0%83%E7%94%A8%E8%BF%94%E5%9B%9E">postman调用返回</a></li>
</ul>
<!-- tocstop -->

<h2><span id="前言">前言</span></h2><p>为了解决什么问题：<br>1.前端传入大量繁琐数据需要校验，会产生大量 if else语句以及try catch语句导致代码冗杂，不美观。用@Validated注解可以很好的解决。它根据实体类配置的校验规则在进入controller接口的时候就会自动校验参数。<br>2.controller中每一个接口请求都要对异常进行处理，若接口不断增多，不同的异常也会不断增多，会导致异常太过紊乱，不好维护且不好拓展。因此用@ControllerAdvice+@ExceptionHandler对异常做统一处理。</p>
<h2><span id="正文">正文</span></h2><p>为了更方便的理解，这里采用demo，提供登录和注册2个接口的方式给大家阐述。<br><img src="https://img-blog.csdnimg.cn/20200629190800602.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDI1ODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>1.编写登录实体类UserLoginReq和注册实体类UserRegisterReq(这里@Getter@Sette注解用的lombok插件可以省去写get，set方法)</strong><br>@NotEmpty注解校验是否为空<br>@Size校验字符串的长度<br>@Pattern正则表达式校验字符串<br>UserLoginReq：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Getter</span><br><span class="line">@Setter</span><br><span class="line">public class UserLoginReq &#123;</span><br><span class="line">    @NotEmpty(message &#x3D; &quot;用户姓名不能为空&quot;)</span><br><span class="line">    @Size(max &#x3D; 64, message &#x3D; &quot;用户姓名长度不能超过64位&quot;)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    @NotEmpty(message &#x3D; &quot;密码不能为空&quot;)</span><br><span class="line">    private String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>UserRegisterReq：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@Getter</span><br><span class="line">@Setter</span><br><span class="line">public class UserRegisterReq &#123;</span><br><span class="line">    @NotEmpty(message &#x3D; &quot;用户姓名不能为空&quot;)</span><br><span class="line">    @Size(max &#x3D; 64, message &#x3D; &quot;用户姓名长度不能超过64位&quot;)</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    @NotEmpty(message &#x3D; &quot;用户证件类型不能为空&quot;)</span><br><span class="line">    @Pattern(regexp &#x3D; &quot;^(01|02|03|04|99)$&quot;, message &#x3D; &quot;用户证件类型错误&quot;)</span><br><span class="line">    private String cardType;</span><br><span class="line"></span><br><span class="line">    @NotEmpty(message &#x3D; &quot;用户证件号码不能为空&quot;)</span><br><span class="line">    @Size(max &#x3D; 32, message &#x3D; &quot;用户证件号码长度不能超过32位&quot;)</span><br><span class="line">    private String cardNo;</span><br><span class="line"></span><br><span class="line">    @NotEmpty(message &#x3D; &quot;用户联系电话不能为空&quot;)</span><br><span class="line">    @Size(max &#x3D; 32, message &#x3D; &quot;用户联系电话长度不能超过32位&quot;)</span><br><span class="line">    private String contactNo;</span><br><span class="line"></span><br><span class="line">    @Size(max &#x3D; 128, message &#x3D; &quot;联系地址长度不能超过128位&quot;)</span><br><span class="line">    private String contactAddress;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.pom.xml引入依赖<br>（1）spring-boot-starter-validation：提供上示代码中@NotEmpty，@Size，@Pattern等注解校验参数，message参数用于校验失败响应值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 校验入参 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;spring-boot-starter-validation&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>
<p>（2）hutool-all：hutool工具类，是一个很强大的工具类，提供如日期，克隆，类型转化等等很多方法简化代码开发，这里只是用于创建json对象和创建随机数（与此文核心内容无关）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- hutool工具 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;cn.hutool&lt;&#x2F;groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;hutool-all&lt;&#x2F;artifactId&gt;</span><br><span class="line">  &lt;version&gt;4.6.13&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>
<p>3.编写controller接口，自定义异常枚举类和请求返回result类<br>UserController：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class UserController &#123;</span><br><span class="line">    @PostMapping(value &#x3D; &quot;&#x2F;register&quot;)</span><br><span class="line">    public void exceptionLoginDemo(@Validated UserRegisterReq userRegisterReq) &#123;</span><br><span class="line">        System.out.println(&quot;user register!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @PostMapping(value &#x3D; &quot;&#x2F;login&quot;)</span><br><span class="line">    public void exceptionRegisterDemo(@Validated UserLoginReq userLoginReq) &#123;</span><br><span class="line">        System.out.println(&quot;user login!&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ExceptionEnum ：枚举类，自定义异常枚举</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">public enum ExceptionEnum &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 请求异常集</span><br><span class="line">    LOGIN_PARAM_EXCEPTION(&quot;100101&quot;, &quot;登录请求参数错误异常&quot;),</span><br><span class="line">    REGISTER_PARAM_EXCEPTION(&quot;100102&quot;, &quot;注册请求参数错误异常&quot;,true),</span><br><span class="line">    &#x2F;&#x2F;系统未知异常</span><br><span class="line">    UNKNOWN_EXCEPTION(&quot;990101&quot;, &quot;未知异常&quot;, true);</span><br><span class="line">    &#x2F;&#x2F; 错误码</span><br><span class="line">    private String code;</span><br><span class="line">    &#x2F;&#x2F; 响应信息</span><br><span class="line">    private String message;</span><br><span class="line">    &#x2F;&#x2F; 异常发现是否警告（此参数这里不考虑，只是用于拓展，比如异常发生会通知异常监听系统发出警告）</span><br><span class="line">    private boolean isWarn;</span><br><span class="line">    </span><br><span class="line">    ExceptionEnum(String code, String message) &#123;</span><br><span class="line">        this.code &#x3D; code;</span><br><span class="line">        this.message &#x3D; message;</span><br><span class="line">        this.isWarn &#x3D; false;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ExceptionEnum(String code, String message, boolean isWarn) &#123;</span><br><span class="line">        this.code &#x3D; code;</span><br><span class="line">        this.message &#x3D; message;</span><br><span class="line">        this.isWarn &#x3D; isWarn;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public String getCode() &#123;</span><br><span class="line">        return this.code;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getMessage() &#123;</span><br><span class="line">        return this.message;</span><br><span class="line">    &#125;</span><br><span class="line">    public boolean isWarn() &#123;</span><br><span class="line">        return this.isWarn;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Result：自定义返回给用户的结果集：错误码code，信息message，以及响应成功或失败的response数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">@Getter</span><br><span class="line">@Setter</span><br><span class="line">public class Result implements Serializable &#123;</span><br><span class="line">    private static final long serialVersionUID &#x3D; -4127817000970452353L;</span><br><span class="line">    &#x2F;&#x2F;默认成功正常</span><br><span class="line">    private static final String SUCCESS_CODE &#x3D; &quot;200&quot;;</span><br><span class="line">    &#x2F;&#x2F;默认成功消息</span><br><span class="line">    private static final String SUCCESS_MESSAGE &#x3D; &quot;SUCCESS&quot;;</span><br><span class="line">    &#x2F;&#x2F;状态</span><br><span class="line">    private String code;</span><br><span class="line">    &#x2F;&#x2F;消息</span><br><span class="line">    private String message;</span><br><span class="line">    &#x2F;&#x2F;数据</span><br><span class="line">    private Object response;</span><br><span class="line">    </span><br><span class="line">    private Result(Builder builder) &#123;</span><br><span class="line">        code &#x3D; builder.code &#x3D;&#x3D; null ? SUCCESS_CODE : builder.code + &quot;&quot;;</span><br><span class="line">        message &#x3D; builder.message &#x3D;&#x3D; null ? SUCCESS_MESSAGE : builder.message;</span><br><span class="line">        response &#x3D; builder.response;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public static Builder newBuilder() &#123;</span><br><span class="line">        return new Builder();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public static final class Builder &#123;</span><br><span class="line">        private Integer code;</span><br><span class="line">        private String message;</span><br><span class="line">        private Object response;</span><br><span class="line">        private Builder() &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        public Builder code(Integer val) &#123;</span><br><span class="line">            code &#x3D; val;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">        public Builder message(String val) &#123;</span><br><span class="line">            message &#x3D; val;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">        public Builder response(Object val) &#123;</span><br><span class="line">            response &#x3D; val;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line">        public Result build() &#123;</span><br><span class="line">            return new Result(this);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return JSONUtil.toJsonStr(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>4.编写3个异常类以及异常handle：1个父异常FatherException，2个子异常ChildLoginException，ChildRegisterException，ExceptionHandle<br><strong>这里示例2个自定义子异常，实际工作中可动态拓展新增多个异常处理</strong><br>FatherException：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public abstract class FatherException extends Exception&#123;</span><br><span class="line">    private static final long serialVersionUID &#x3D; 2287623661547050627L;</span><br><span class="line">    </span><br><span class="line">    protected boolean isWarn;</span><br><span class="line">    </span><br><span class="line">    protected String code;</span><br><span class="line">    </span><br><span class="line">    protected String message;</span><br><span class="line"></span><br><span class="line">    public FatherException(ExceptionEnum exceptionEnum, String type, JSONObject params) &#123;</span><br><span class="line">        this.code &#x3D; exceptionEnum.getCode();</span><br><span class="line">        this.message &#x3D; exceptionEnum.getMessage();</span><br><span class="line">        this.isWarn &#x3D; exceptionEnum.isWarn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ChildLoginException：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class ChildLoginException extends FatherException &#123;</span><br><span class="line">    private static final long serialVersionUID &#x3D; -7065580338200227702L;</span><br><span class="line">    </span><br><span class="line">    private static final String EXCEPTION_TYPE &#x3D; &quot;LOGIN&quot;;</span><br><span class="line">    </span><br><span class="line">    public ChildLoginException(ExceptionEnum exceptionEnum, JSONObject params) &#123;</span><br><span class="line">        super(exceptionEnum, EXCEPTION_TYPE, params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ChildRegisterException:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class ChildRegisterException extends FatherException &#123;</span><br><span class="line">    private static final long serialVersionUID &#x3D; 816726270176940141L;</span><br><span class="line">    </span><br><span class="line">    private static final String EXCEPTION_TYPE &#x3D; &quot;REGISTER&quot;;</span><br><span class="line">    </span><br><span class="line">    public ChildRegisterException(ExceptionEnum exceptionEnum, JSONObject params) &#123;</span><br><span class="line">        super(exceptionEnum, EXCEPTION_TYPE, params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>核心类</strong>：<br>ExceptionHandle<br><strong>当请求来的时候，校验失败会进入ExceptionHandle类，通过instanceof 关键字根据异常类型去跑各自具体的异常处理逻辑，如登录就处理登录的异常，注册就处理注册的异常，若是BindException则是参数校验失败，根据请求url，封装各自的result返回值返回给用户</strong><br>（提示：代码中Result.newBuilder()等于new Result（），这是lombok插件创建对象的写法）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">@ControllerAdvice</span><br><span class="line">public class ExceptionHandle &#123;</span><br><span class="line">    private Logger logger &#x3D; LoggerFactory.getLogger(ExceptionHandle.class);</span><br><span class="line">    </span><br><span class="line">    private Snowflake snowflake &#x3D; IdUtil.createSnowflake(1, 1);</span><br><span class="line">    </span><br><span class="line">    @ExceptionHandler(Exception.class)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public Result handle(Exception exception, HttpServletRequest request) &#123;</span><br><span class="line">        &#x2F;*</span><br><span class="line">        创建一个json Response对象（这里写法是因为用的huto工具类） ，请求返回值形如</span><br><span class="line">        data &#x3D; &#123;</span><br><span class="line">                  &quot;code&quot;: &quot;100101&quot;,</span><br><span class="line">                  &quot;message&quot;: &quot;用户证件类型错误&quot;,</span><br><span class="line">                  &quot;response&quot;: &#123;</span><br><span class="line">                      &quot;reqId&quot;: &quot;1277545207021309952&quot;</span><br><span class="line">                   &#125;</span><br><span class="line">                &#125;</span><br><span class="line">         *&#x2F;</span><br><span class="line">        JSONObject data &#x3D; JSONUtil.createObj();</span><br><span class="line">        &#x2F;&#x2F; 生成随机数（huto工具类的方法）</span><br><span class="line">        data.put(&quot;reqId&quot;, snowflake.nextIdStr());</span><br><span class="line"></span><br><span class="line">        if (exception instanceof FatherException) &#123;</span><br><span class="line">            &#x2F;*</span><br><span class="line">            处理自定义的FatherException异常</span><br><span class="line">             *&#x2F;</span><br><span class="line">            </span><br><span class="line">        &#125; else if (exception instanceof ChildLoginException) &#123;</span><br><span class="line">            &#x2F;*</span><br><span class="line">            处理ChildLoginException 登录的异常</span><br><span class="line">             *&#x2F;</span><br><span class="line">        &#125; else if (exception instanceof ChildRegisterException) &#123;</span><br><span class="line">            &#x2F;*</span><br><span class="line">            处理ChildRegisterException 注册的异常</span><br><span class="line">             *&#x2F;</span><br><span class="line">        &#125; else if (exception instanceof BindException) &#123;</span><br><span class="line">            &#x2F;&#x2F; 取得请求的url</span><br><span class="line">            String reqUrl &#x3D; this.getRequestUrl(request);</span><br><span class="line">            &#x2F;&#x2F; 取得BindException异常提示信息</span><br><span class="line">            String message &#x3D; this.getBindExceptionMessage((BindException) exception);</span><br><span class="line">            switch (reqUrl) &#123;</span><br><span class="line">                &#x2F;&#x2F; 请求一：登录</span><br><span class="line">                case &quot;&#x2F;login&quot;:</span><br><span class="line">                    request.setAttribute(&quot;resCode&quot;, ExceptionEnum.LOGIN_PARAM_EXCEPTION.getCode());</span><br><span class="line">                    return Result.newBuilder().code(Integer.valueOf(ExceptionEnum.LOGIN_PARAM_EXCEPTION.getCode())).message(message).response(data).build();</span><br><span class="line">                &#x2F;&#x2F; 请求二：注册</span><br><span class="line">                case &quot;&#x2F;register&quot;:</span><br><span class="line">                    request.setAttribute(&quot;resCode&quot;, ExceptionEnum.REGISTER_PARAM_EXCEPTION.getCode());</span><br><span class="line">                    return Result.newBuilder().code(Integer.valueOf(ExceptionEnum.REGISTER_PARAM_EXCEPTION.getCode())).message(message).response(data).build();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            &#x2F;&#x2F; 处理未知异常</span><br><span class="line">            logger.error(exception.getMessage(), exception);</span><br><span class="line">            request.setAttribute(&quot;resCode&quot;, ExceptionEnum.UNKNOWN_EXCEPTION.getCode());</span><br><span class="line">            return Result.newBuilder().code(Integer.valueOf(ExceptionEnum.UNKNOWN_EXCEPTION.getCode())).message(ExceptionEnum.UNKNOWN_EXCEPTION.getMessage()).response(data).build();</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2><span id="postman调用返回">postman调用返回</span></h2><p>返回响应码code，响应信息message，返回值response<br>1.注册证件类型支持01，02，03，04，99.不支持22报证件类型错误<br><img src="https://img-blog.csdnimg.cn/20200629192505882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDI1ODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.登录密码不能为空<br><img src="https://img-blog.csdnimg.cn/20200629192602414.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDI1ODAz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>本文以及demo已收录至GitHub地址：<a target="_blank" rel="noopener" href="https://github.com/taochengbin/spring/tree/master/springMvc-global-exception">https://github.com/taochengbin/spring/tree/master/springMvc-global-exception</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">陶成彬</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2020/10/15/springboot%E4%B8%AD@Validated+@ControllerAdvice+@ExceptionHandler%E6%B3%A8%E8%A7%A3%E5%AF%B9%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86/">http://example.com/2020/10/15/springboot%E4%B8%AD@Validated+@ControllerAdvice+@ExceptionHandler%E6%B3%A8%E8%A7%A3%E5%AF%B9%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Ruby</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/wall/2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/10/15/%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%EF%BC%8C%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%EF%BC%8C%E8%AF%81%E4%B9%A6%E9%93%BE%E5%8E%9F%E7%90%86%EF%BC%88%E5%9B%BE%E6%96%87%E8%AF%A6%E8%A7%A3%EF%BC%89/"><img class="prev-cover" src="/img/wall/3.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">数字签名，数字证书，证书链原理（图文详解）</div></div></a></div><div class="next-post pull-right"><a href="/2020/10/15/Oracle%E5%88%86%E8%A1%A8%E5%88%86%E5%8C%BA%E5%AE%9E%E6%88%98%EF%BC%88%E5%90%AB%E7%B4%A2%E5%BC%95%EF%BC%8C%E6%A3%80%E6%9F%A5%E5%A4%84%E7%90%86%EF%BC%89/"><img class="next-cover" src="/img/wall/1.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Oracle分表分区实战（含索引，检查处理）</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" style="background-image: url(/img/wall/2.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 By 陶成彬</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const initData = {
      el: '#vcomment',
      appId: '8zYTuWegqhzdK0d62LhlAD7q-gzGzoHsz',
      appKey: 'W8CqvWuCpU9ApxOWbwIIwEVS',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }

    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>